### 2.1 对象数据库
git 仓库中存储了非常多的信息，比如分支、版本树，版本变更信息，文件树等等，那么 git 是如何存储这些数据的呢 ？




> git 生成的 sha 值一般用 160 位二进制表示，而 key 一般是采用转换后的 40 位 十六进制表示，在一般项目中，只需前几位 sha 值就可以对对象进行区分，所以 key 的唯一前缀也可当作此对象的key。

git 是通过一种称为 对象数据库 的方式来组织和存储数据，是以key-value的形式来存储数据，其中 value 是经过加密压缩后的对象内容，无法直接查看，key 则是哈希算法根据对象内容生成的 sha 值。

key 作为对象文件名，value 值作为文件内容。对象存储在 .git 的 objects 目录下，为了减轻文件系统的压力，git 会将 key 的前两位值取出新建一个文件夹，在其中存放对象。除此之外，为了节省空间，git 会把对象文件压缩后存储在 pack 文件中。

> git 中多个版本的同一个文件的内容相似性很大，所以可压缩的空间很大。

在 git 中，数据被分为四种类型的对象：

- blob(binary large object)：二进制大对象，存储着文件的数据内容，不包含文件的 metadata 信息(比如文件名)。
  > 当文件变更时，会对该文件创建一个新的 blob 对象，旧的 blob 对象不会删除。
- tree：树对象，存储着文件的目录结构，一个对象代表一层目录结构，记录着 blob 标识符、路径名以及当前文件夹下的所有文件的 metadata 信息，通过递归，可以将当前文件夹的目录结构复原。
- commit(提交)：版本变更对象，保存着每次版本变化的 metadata 数据(包括提交者、提交日期、提交日志)、父commit 对象列表 、 tree 对象。
  1. 通过每个commit和父commit 对象列表的关联关系，可以将commit 追溯成一个 DAG (有向无环图)，这就是版本树。
  2. tree 对象保存着项目的顶级目录结构。
- tag(标签)：标签对象，分配一个任意的且可读的对象。